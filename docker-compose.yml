services:
  server:
    build:
      context: ./server
    container_name: digital-egp-server
    env_file:
      - ./server/.env
    environment:
      - PORT=5001
      - GOOGLE_APPLICATION_CREDENTIALS=/app/credentials/service-account.json
    volumes:
      - ${GOOGLE_APPLICATION_CREDENTIALS_HOST:-./server/credentials/service-account.json}:/app/credentials/service-account.json:ro
    ports:
      - "5001:5001"
    restart: unless-stopped

  client:
    build:
      context: ./client
      args:
        VITE_API_BASE_URL: ${VITE_API_BASE_URL:-http://localhost:5001/api}
    container_name: digital-egp-client
    ports:
      - "8080:80"
    depends_on:
      - server
    restart: unless-stopped
